<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!-- bootstap css -->
	<link
		rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.3/css/bootstrap.min.css"
		integrity="sha512-SbiR/eusphKoMVVXysTKG/7VseWii+Y3FdHrt0EpKgpToZeemhqHeZeLWLhJutz/2ut2Vw1uQEj2MbRF+TVBUA=="
		crossorigin="anonymous" referrerpolicy="no-referrer"
	/>

	<!-- jquery -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.4/jquery.min.js" integrity="sha512-pumBsjNRGGqkPzKHndZMaAG+bir374sORyzM3uulLV14lN5LyykqNk8eEeUlUkB3U0M4FApyaHraT65ihJhDpQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

	<!-- local script -->
	<script src="client.js"></script>
	
    <script type="module" src="charts.js"></script>

	<!-- Import jQuery and PhotoSwipe Scripts -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.0/photoswipe.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.0/photoswipe-ui-default.min.js"></script>
	<!-- Import PhotoSwipe Styles -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.0/photoswipe.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.0/default-skin/default-skin.css">
	
	<title>Pain(tings) analysis</title>

	<style>
		.container {
			max-width: 100%;
			/* max-height: 100%; */
			height: 100%;
		}
		.row {
			height: 100%;
		}
		.center {
			display: inline-block;
			height: 100%;
			/* width: 100%; */
			vertical-align: middle;
			text-align: center;
			padding: 10px;
		}
		img {
			max-width: 100%;
			object-fit: contain;
		}
		.col-8,
		.col-6,
		.col-4,
		.col,
		.row {
			border: 1px solid black;
		}
		figure {
			margin: 0%;
		}
	</style>

</head>

<body>

	<div class="container">
		<div class="row" style="height: 100vh;">
			<h1 class="text-center py-4" style="max-height: 5vh;">X by time period</h1>
			<div class="col-4" style="height: 90vh;">
				<div style="width: 100%; height: 100%">
					<canvas id="barChart"></canvas>
				</div>
			</div>

			<div class="col-8" style="height: 90vh;">

				<!-- Galley wrapper that contains all items -->
				<div id="gallery" class="gallery" itemscope itemtype="http://schema.org/ImageGallery" style="height: 100%;">
					
					<div class="container">
						<div class="row">
			
							<div class="col-8">
								<div class="row" style="height: 60vh;" id="box-0">
									<figure class="center" itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject">
										<a href="http://localhost:3000/img_collection/baroque/0" id="a-0" data-caption="lorem ipsum" data-width="1200" data-height="900" itemprop="contentUrl">
										  <img class="center" src="https://unsplash.it/400/300/?image=695" itemprop="thumbnail" alt="Image description">
										</a>
									</figure>
								</div>
								<div class="row" style="height: 30vh;">
									<div class="col-6" style="height: 30vh;" id="box-1">
										<figure style="max-height: 30vh; width: 100%;" class="center" itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject">
											<a href="https://unsplash.it/1200/900/?image=702" id="a-1" data-caption="lorem ipsum" data-width="1200" data-height="900" itemprop="contentUrl">
											  <img class="center" src="https://unsplash.it/400/300/?image=702" itemprop="thumbnail" alt="Image description">
											</a>
										  </figure>
									</div>
									<div class="col-6" style="height: 30vh;" id="box-2">
										<figure style="max-height: 30vh; width: 100%;" class="center" itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject">
											<a href="https://unsplash.it/1200/900/?image=695" id="a-2" data-caption="lorem ipsum" data-width="1200" data-height="900" itemprop="contentUrl">
											  <img class="center" src="https://unsplash.it/400/300/?image=695" itemprop="thumbnail" alt="Image description">
											</a>
										  </figure>
									</div>
								</div>
							</div>
						
							<div class="col-4" style="height: 90vh;">
								<div class="row" style="height: 30vh;">
									<div class="col mini-box" id="box-3">
										<figure class="center" style="max-height: 30vh; width: 100%;" itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject">
											<a href="https://unsplash.it/1200/900/?image=702" id="a-3" data-caption="lorem ipsum" data-width="1200" data-height="900" itemprop="contentUrl">
											  <img style="max-width: 20vw;" class="center" src="https://unsplash.it/400/300/?image=702" itemprop="thumbnail" alt="Image description">
											</a>
										  </figure>
									</div>
								</div>
								<div class="row" style="height: 30vh;">
									<div class="col mini-box" id="box-4">
										<figure class="center" style="max-height: 30vh; width: 100%;" itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject">
											<a href="https://unsplash.it/1200/900/?image=702" id="a-4" data-caption="lorem ipsum" data-width="1200" data-height="900" itemprop="contentUrl">
											  <img style="max-width: 20vw;" class="center" src="https://unsplash.it/400/300/?image=702" itemprop="thumbnail" alt="Image description">
											</a>
										  </figure>
									</div>
								</div>
								<div class="row" style="height: 30vh;">
									<div class="col mini-box" id="box-5">
										<figure class="center" style="max-height: 30vh; width: 100%;" itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject">
											<a href="https://unsplash.it/1200/900/?image=702" id="a-5" data-caption="lorem ipsum" data-width="1200" data-height="900" itemprop="contentUrl">
											  <img style="max-width: 20vw;" class="center" src="https://unsplash.it/400/300/?image=702" itemprop="thumbnail" alt="Image description">
											</a>
										  </figure>
									</div>
								</div>
							</div>
			
						</div>
					</div>

				</div>

			</div>

		</div>
	</div>

	<!-- Root element of PhotoSwipe. Must have class pswp. -->
	<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
		<!-- Background of PhotoSwipe. 
			It's a separate element as animating opacity is faster than rgba(). -->
		<div class="pswp__bg"></div>
		<!-- Slides wrapper with overflow:hidden. -->
		<div class="pswp__scroll-wrap">
			<!-- Container that holds slides. 
				PhotoSwipe keeps only 3 of them in the DOM to save memory.
				Don't modify these 3 pswp__item elements, data is added later on. -->
			<div class="pswp__container">
				<div class="pswp__item"></div>
				<div class="pswp__item"></div>
				<div class="pswp__item"></div>
			</div>
			<!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
			<div class="pswp__ui pswp__ui--hidden">
				<div class="pswp__top-bar">
					<!--  Controls are self-explanatory. Order can be changed. -->
					<div class="pswp__counter"></div>
					<button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
					<button class="pswp__button pswp__button--share" title="Share"></button>
					<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
					<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
					<!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
					<!-- element will get class pswp__preloader--active when preloader is running -->
					<div class="pswp__preloader">
						<div class="pswp__preloader__icn">
						<div class="pswp__preloader__cut">
							<div class="pswp__preloader__donut"></div>
						</div>
						</div>
					</div>
				</div>
				<div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
					<div class="pswp__share-tooltip"></div> 
				</div>
				<button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
				</button>
				<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
				</button>
				<div class="pswp__caption">
					<div class="pswp__caption__center"></div>
				</div>
			</div>
		</div>
	</div>

	<script>
		'use strict';
	
		(function($){
	
			// Define click event on gallery item
			$('a').click(function(event){
	
				// Prevent location change
				event.preventDefault();

				// Init empty gallery array
				let container = [];
				let a_id = event.currentTarget.id;
		
				// Loop over gallery items and push it to the array
				let imageVariants = ["", "_pose", "_lines"];
				let variant2str = {
					"": "Default",
					"_pose": "Pose",
					"_lines": "Lines"
				};
				let variant2path = {
					"": "/img_collection/default",
					"_pose": "/img_collection/pose",
					"_lines": "/img_collection/lines"
				}

				let link = $("#" + a_id);
				let imageSpecifier = link.attr('href').match(/\/[^/]+\/[0-9]+/g);
				let promiseDim = $.getJSON(serverUrl + "/img_collection/dim" + imageSpecifier);

				promiseDim.done(dimensions => {

					imageVariants.forEach(imageVariant => {
					
						let imagePath = serverUrl + variant2path[imageVariant] + imageSpecifier;
						
						let item = {
							src: imagePath,
							w: dimensions['width'],
							h: dimensions['height'],
							title: variant2str[imageVariant]	// link.data('caption')
						};
						container.push(item);

					});

					// Define object and gallery options
					var $pswp = $('.pswp')[0],
						options = {
							index: $(this).parent('figure').index(),
							bgOpacity: 0.85,
							showHideOpacity: true
						};
			
					// Initialize PhotoSwipe
					var gallery = new PhotoSwipe($pswp, PhotoSwipeUI_Default, container, options);
					gallery.init();

				});

			});
		}(jQuery));
	</script>
    
</body>

</html>
